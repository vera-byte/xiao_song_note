# åˆ©ç”¨å®å¡”webhookå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²
## ç¯å¢ƒä¾èµ–
- Git
- æœåŠ¡å™¨å¿…é¡»è£…æœ‰WebHook (æˆ–è€…ä½¿ç”¨å®å¡”)
## webhookå‘½ä»¤
``` sh
echo "-------------------------ä»»åŠ¡å¼€å§‹-----------------------------"
echo "$(date +'%Y-%m-%d %H:%M:%S')|$1å¼€å§‹è°ƒç”¨æ¥å£"
cd /www/wwwroot/note.metoyun.com/note #ç½‘ç«™æ ¹ç›®å½•
git pull --rebase --no-rebase # é€šè¿‡git pull æ‹‰å–æ–°çš„ä»£ç 
echo "$(date +'%Y-%m-%d %H:%M:%S')|$1è°ƒç”¨æ¥å£æ‰§è¡Œå®Œæ¯•"
echo "-------------------------ä»»åŠ¡ç»“æŸ-----------------------------"

```

## ç¼–å†™shè„šæœ¬ç¤ºä¾‹

``` sh
#!/usr/bin/env sh
# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯
set -e

echo "ğŸ˜€-------æ­£åœ¨æ‰“åŒ…é¡¹ç›®Â·Â·Â·-------"
# vuepress build docsä¸ºVuepressæ‰“åŒ…å‘½ä»¤
vuepress build docs

echo "ğŸ‘-------æ·»åŠ æ–‡ä»¶åˆ°ä»“åº“-------"
# æ·»åŠ æ‰€æœ‰æ›´æ”¹çš„æ–‡ä»¶åˆ°gitæš‚å­˜åŒº
git add .

echo "ğŸ˜¯-------å†™å…¥æäº¤ä¿¡æ¯-------"
# å¡«å†™Git æäº¤ä¿¡æ¯
git commit -m "Updated $(date +'%Y-%m-%d %H:%M:%S')"

echo "ğŸ˜¸æäº¤ä»“åº“"
# æäº¤åˆ°è¿œç¨‹ä»“åº“
git push -u origin master

echo "ğŸ¤¤$(date +'%Y-%m-%d %H:%M:%S')|å¼€å§‹åˆ°ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²"
# å¡«å†™webhookåœ°å€
res=$(curl webhookåœ°å€)

echo "ğŸ˜¯-------å‘é€WebHook-------"

echo $res
# code 1 åˆ™æ‰§è¡ŒæˆåŠŸ

if [ "$res" == '{"code": 1}' ];then
# èµ°åˆ°æ­¤æ­¥éª¤æ—¢å¯è¯´æ˜è‡ªå·±çš„äº‘æœåŠ¡å™¨å·²ç»æ¥å—åˆ°webhookå‘½ä»¤
echo "ğŸ˜ $(date +'%Y-%m-%d %H:%M:%S')|ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è¯·æ±‚å·²æ¥å—."

else
# webhookè¯·æ±‚å¤±è´¥
echo "ğŸ˜¨ $(date +'%Y-%m-%d %H:%M:%S')|éƒ¨ç½²è¯·æ±‚æœªæ”¶åˆ°æ­£å¸¸å›åº”,è¯·æ£€æŸ¥é…ç½®!"

fi
```